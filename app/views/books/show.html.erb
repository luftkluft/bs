<main class="container">
  <a href="<%= url_for(:back) %>" class="general-back-link">
    <i class="fa fa-long-arrow-left mr-15"></i>Back to results</a>
  <div class="row">
    <div class="col-sm-6">
      <div class="product-gallery">
        <div class="mb-20">
          <%= image_tag @book.image.url(:size400x300) %>
        </div>
        <div class="images clearfix">
          <a href="#" class="img-link">
            <%= image_tag @book.image_1.url(:size100x80) %> </a>
          <a href="#" class="img-link">
            <%= image_tag @book.image_2.url(:size100x80) %></a>
          <a href="#" class="img-link">
            <%= image_tag @book.image_3.url(:size100x80) %></a>
        </div>
      </div>
    </div>
    <div class="col-sm-6">
      <h1 class="mt-res-0">
        <%= @book.title %>
      </h1>
      <p class="lead small">
        <%= @book.author %>
      </p>
      <div class="row">
        <div class="col-xs-12 col-md-4">
          <p class="h1 in-gold-500 mt-10">â‚¬
            <%= @book.price %>
          </p>
        </div>
        <div class="col-xs-5 col-md-3">
          <div class="input-group general-position">
            <a id="minus_book" href="#" class="input-link">
              <i class="fa fa-minus line-height-40"></i></a>
            <input id="book_count" type="text" class="form-control quantity-input" min="0" max="15" value="1" />
            <a id="plus_book" href="#" class="input-link">
              <i class="fa fa-plus line-height-40"></i></a></div>
        </div>
        <div class="col-xs-7 col-md-5">

          <input id="book-input-book-id" type="hidden" value="<%= @book.id %>" />
          <button id="book-add-to-cart" class="btn btn-default pull-right general-position">Add to Cart</button>

        </div>
      </div>
      <div class="general-info-wrap divider-lg">
        <p>Description</p>
        <p class="lead small line-height-2">
          <% if @book.description.size <= 10 %>
          <%= @book.description.truncate_words(10) %>
          <% else %>
          <%= @book.description.truncate_words(10) %>
          <%= link_to I18n.t('book.description.read_more'), '', class: "read-more-#{@book.id} in-gold-500 ml-10" %>
          <script>
            $(".read-more-<%= @book.id %>").click(function (e) {
              e.preventDefault()
              $(this).parent().html("<%= @book.description %>")
              return false
            })
          </script>
          <% end %>
        </p>
      </div>
      <div class="general-info-wrap divider-lg">
        <div class="clearfix">
          <p class="pull-left">Year of publication</p>
          <p class="lead small pull-right">
            <%= @book.year %>
          </p>
        </div>
      </div>
      <div class="general-info-wrap divider-lg">
        <div class="clearfix">
          <p class="pull-left">Dimensions</p>
          <p class="lead small pull-right">H:
            <%= @book.height %>" x W:
            <%= @book.width %>" x D:
            <%= @book.depth %>"</p>
        </div>
      </div>
      <div class="general-info-wrap divider-lg">
        <div class="clearfix">
          <p class="pull-left">Materials</p>
          <p class="lead small pull-right">
            <%= @book.materials %>
          </p>
        </div>
      </div>
    </div>
  </div>


  <% if user_signed_in? %>
  <div class="mb-80">
    <h3>Write a Review</h3>
    <%= form_for @review do |f| %>
    <div class="col-md-8">
      <div class="mb-40">
        <div class="form-group">
          <input type="hidden" name="book_id" value="<%=@book.id%>" />
          <input type="hidden" name="user_id" value="<%=current_user.id%>" />
          <label class="control-label input-label in-grey-600">Score</label>
          <div class="input-group general-position">
            <a id="minus_score" href="#" class="input-link">
              <i class="fa fa-minus line-height-40"></i></a>
            <input id="score_count" name="score" type="text" class="form-control quantity-input" min="0" max="5" value="1" />
            <a id="plus_score" href="#" class="input-link">
              <i class="fa fa-plus line-height-40"></i></a>
          </div>
          <label class="control-label input-label in-grey-600">Review</label>
          <textarea id="review" name="body" type="text" class="form-control"></textarea>
        </div>
        <div class="text-right">
          <button id="btn_post" class="btn btn-primary mb-20" type="submit">Post</button></div>
      </div>
      <% end %>
      <% end %>

      <div class="mb-80">
        <h3 class="in-gold-500 mb-25">Reviews (
          <%= @approved_reviews.count %>)</h3>
        <% @approved_reviews.each do |review| %>
        <div class="general-message-wrap divider-lg">
          <div class="clearfix">
            <span class="img-circle logo-size inlide-block pull-left logo-empty">
              <%= review.user.name.first.upcase %></span>
            <div class="ml-70">
              <div>
                <div class="general-message-date hidden-xs">
                  <%= review.updated_at.strftime('%d/%m/%Y') %>
                </div>
                <div class="max-240">
                  <div class="general-message-verified pull-right">
                    <!-- Verified -->
                    <%= review.reviewer_name %>
                  </div>
                  <div class="general-message-name">
                    <%= review.user.name %>
                  </div>
                </div>
              </div>
              <div class="mb-15">
                <% review.score.times do %>
                <i class="fa fa-star rate-star"></i>
                <% end %>
                <% (5 - review.score).times do %>
                <i class="fa fa-star rate-star rate-empty"></i>
                <% end %>
              </div>
              <p>
                <%= review.body %>
              </p>
            </div>
          </div>
        </div>
        <% end %>
      </div>
</main>